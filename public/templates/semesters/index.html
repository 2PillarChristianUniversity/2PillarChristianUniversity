<div ng-include="'/templates/navigation.html'"></div>
<div class="container">
    <br>
    <br>
    <uib-tabset active="actTab">
        <uib-tab index="0" select="renderCalendar()" heading="Schedule" active="true" ng-click="renderCalendar('calendar')" ng-if-permission="Student,Professor">
            <br>
            <div id="calendar" ui-calendar="uiConfig.calendar" class="span8 calendar" ng-model="eventSources" calendar="calendar" ng-if-permission="Student,Professor"></div>
        </uib-tab>

        <uib-tab ng-click="loadTreeView()" index="1" heading="{{headPrevCourse}}" ng-if-permission="Admin,Professor">
            <semester-treeview ng-if-permission="Admin,Professor"></semester-treeview>
        </uib-tab>

        <uib-tab index="2" heading="Courses">
            <br>
            <button ng-if-permission="Admin" class="btn btn-primary" ng-click="AddSemester()">Add Semester</button>
            <br ng-if-permission="Admin">
            <br ng-if-permission="Admin">
            <div class="panel panel-default" ng-repeat="semester in semesters">
                <div class="panel-heading">{{semester.name}} ( from: {{semester.startDate | date}} - to: {{semester.endDate | date}} )
                    <span style="float:right">
                        <a href="javascript:void(0)"  ng-if-permission="Admin"  ng-click="editSemester(semester._id)">
                            Edit
                        </a>

                        <a href="javascript:void(0)"  ng-if-permission="Admin"  ng-click="deleteSemester(semester._id)">
                            Delete
                            </a>
                    </span>
                </div>
                <div class="panel-body">
                    <button ng-if-permission="Admin" ng-click="addCourse(semester._id, semester.name)">Add Course</button>
                    <br>
                    <br>
                    <table class="table">
                        <thead>
                            <th>ID</th>
                            <th>Course Name</th>
                            <th>Start Date</th>
                            <th>End Date</th>
                            <th>Professor</th>
                            <th ng-if-permission="Admin,Student">Actions</th>
                        </thead>
                        <tr ng-repeat="course in semester.Courses">
                            <td>{{course._id}}</td>
                            <td>{{course.name}}</td>
                            <td>{{course.startDate | date}}</td>
                            <td>{{course.endDate | date}}</td>
                            <td>
                                <span ng-repeat="professor in checkProfessors(course._id)">
                                    {{professor.firstName}} {{professor.lastName}}
                                </span>
                            </td>
                            <td ng-if-permission="Admin,Student">
                                <a href="javascript:void(0)" ng-if-permission="Admin" ng-click="editCourse(semester.name ,course._id)">Edit</a>
                                <a href="javascript:void(0)" ng-if-permission="Admin" ng-click="deleteCourse(course._id)">Delete</a>
                                <a ng-if="coursesOfStudents.indexOf(course._id) > -1" href="javascript:void(0)" ng-if-permission="Student" ng-click="unEnRollClass(course._id)">Un-Enroll </a>
                                <a ng-if="coursesOfStudents.indexOf(course._id) <= -1" href="javascript:void(0)" ng-if-permission="Student" ng-click="enRollClass(course._id)">Enroll </a>
                                <a href="javascript:void(0)" ng-if-permission="Admin" ng-click="assignCourse(course._id)">Assign </a>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </uib-tab>

        <uib-tab index="4" heading="History" ng-if-permission="Student">
            <table class="table">
                <thead>
                    <th>ID</th>
                    <th>Course Name</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Grade</th>
                </thead>
                <tbody>
                    <tr ng-repeat="grade in studentCourses">
                        <td>
                            <p>{{grade.courseID}}</p>
                        </td>
                        <td>
                            <p>{{grade.Courses[0].name}}</p>
                        </td>
                        <td>
                            <p>{{grade.Courses[0].startDate | date}}</p>
                        </td>
                        <td>
                            <p>{{grade.Courses[0].endDate | date}}</p>
                        </td>
                        <td>
                            {{grade.grade}}
                        </td>
                    </tr>
                </tbody>
            </table>
        </uib-tab>

    </uib-tabset>
    </div>
